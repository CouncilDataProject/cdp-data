<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="cdp_data.utils package" href="cdp_data.utils.html" /><link rel="prev" title="cdp_data" href="modules.html" />

    <meta name="generator" content="sphinx-4.5.0, furo 2022.04.07"/>
        <title>cdp_data package - cdp-data 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=68f4518137b9aefe99b631505a2064c3c42c9852" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">cdp-data 0.0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">cdp-data 0.0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="modules.html">Package modules</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children current-page"><a class="current reference internal" href="#">cdp_data package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="cdp_data.utils.html">cdp_data.utils package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="cdp-data-package">
<h1>cdp_data package<a class="headerlink" href="#cdp-data-package" title="Permalink to this headline">#</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">#</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="cdp_data.utils.html">cdp_data.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cdp_data.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdp_data.utils.html#module-cdp_data.utils.db_utils">cdp_data.utils.db_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdp_data.utils.html#module-cdp_data.utils.fs_utils">cdp_data.utils.fs_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="cdp_data.utils.html#module-cdp_data.utils">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">#</a></h2>
</section>
<section id="module-cdp_data.constants">
<span id="cdp-data-constants-module"></span><h2>cdp_data.constants module<a class="headerlink" href="#module-cdp_data.constants" title="Permalink to this headline">#</a></h2>
</section>
<section id="module-cdp_data.datasets">
<span id="cdp-data-datasets-module"></span><h2>cdp_data.datasets module<a class="headerlink" href="#module-cdp_data.datasets" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="cdp_data.datasets.get_session_dataset">
<span class="sig-prename descclassname"><span class="pre">cdp_data.datasets.</span></span><span class="sig-name descname"><span class="pre">get_session_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infrastructure_slug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_datetime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">datetime.datetime</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_datetime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">datetime.datetime</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_full_metadata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_transcript</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transcript_selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'confidence'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_video</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_audio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/cdp_data/datasets.html#get_session_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdp_data.datasets.get_session_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Get a dataset of sessions from a CDP infrastructure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infrastructure_slug</strong> (<em>str</em>) – The CDP infrastructure to connect to and pull sessions for.</p></li>
<li><p><strong>start_datetime</strong> (<em>Optional[Union[str, datetime]]</em>) – An optional datetime that the session dataset will start at.
Default: None (no datetime beginning bound on the dataset)</p></li>
<li><p><strong>end_datetime</strong> (<em>Optional[Union[str, datetime]]</em>) – An optional datetime that the session dataset will end at.
Default: None (no datetime end bound on the dataset)</p></li>
<li><p><strong>store_full_metadata</strong> (<em>bool</em>) – Should a JSON file of the full event metadata be stored to disk and a
path to the stored JSON file be added to the returned DataFrame.
Default: False (do not request extra data and store to disk)
<strong>Currently not implemented</strong></p></li>
<li><p><strong>store_transcript</strong> (<em>bool</em>) – Should a session transcript be requested and stored to disk and a path
to the stored transcript JSON file be added to the returned DataFrame.
Default: False (do not request extra data and do not store the transcript)</p></li>
<li><p><strong>transcript_selection</strong> (<em>str</em>) – How should the single transcript be selected.
Options: “confidence” for transcript with the highest confidence value,
“created” for the most recently created transcript.
Default: “confidence” (Return the single highest confidence
transcript per session)</p></li>
<li><p><strong>store_video</strong> (<em>bool</em>) – Should the session video be requested and stored to disk and a path to the
stored video file be added to the returned DataFrame.
Default: False (do not request and store the video)</p></li>
<li><p><strong>store_audio</strong> (<em>bool</em>) – Should the session audio be requested and stored to disk and a path to the
stored audio file be added to the returned DataFrame.
Default: False (do not request and store the audio)</p></li>
<li><p><strong>cache_dir</strong> (<em>Optional[Union[str, Path]]</em>) – An optional directory path to cache the dataset. Directory is created if it
does not exist.
Default: “./cdp-datasets”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dataset</strong> – The dataset with all additions requested.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All file additions (transcript, full event metadata, video, audio, etc.) are cached
to disk to avoid multiple downloads. If you use the same cache directory multiple
times over the course of multiple runs, no new data will be downloaded, but the
existing files will be used. Caching is done by simply file existence not by a
content hash comparison.</p>
<p>Datasets are cached with the following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{cache-dir}/
└── {infrastructure_slug}
    ├── event-{event-id-0}
    │   ├── metadata.json
    │   └── session-{session-id-0}
    │       ├── audio.wav
    │       ├── transcript.json
    │       └── video.mp4
    ├── event-{event-id-1}
    │   ├── metadata.json
    │   └── session-{session-id-0}
    │       ├── audio.wav
    │       ├── transcript.json
    │       └── video.mp4
    ├── event-{event-id-2}
    │   ├── metadata.json
    │   └── session-{session-id-0}
    │       ├── audio.wav
    │       ├── transcript.json
    │       └── video.mp4
    │   └── session-{session-id-1}
    │       ├── audio.wav
    │       ├── transcript.json
    │       └── video.mp4
</pre></div>
</div>
<p>To clean a whole dataset or specific events or sessions simply delete the
associated directory.</p>
</dd></dl>
</section>
<section id="module-cdp_data.keywords">
<span id="cdp-data-keywords-module"></span><h2>cdp_data.keywords module<a class="headerlink" href="#module-cdp_data.keywords" title="Permalink to this headline">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="cdp_data.keywords.compute_ngram_usage_history">
<span class="sig-prename descclassname"><span class="pre">cdp_data.keywords.</span></span><span class="sig-name descname"><span class="pre">compute_ngram_usage_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">infrastructure_slug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngram_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_datetime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">datetime.datetime</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_datetime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">datetime.datetime</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/cdp_data/keywords.html#compute_ngram_usage_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdp_data.keywords.compute_ngram_usage_history" title="Permalink to this definition">#</a></dt>
<dd><p>Pull the minimal data needed for a session dataset for the provided infrastructure
and start and end datetimes, then compute the ngram usage history DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>infrastructure_slug</strong> (<em>str</em>) – The CDP infrastructure(s) to connect to and pull sessions for.</p></li>
<li><p><strong>ngram_size</strong> (<em>int</em>) – The ngram size to use for counting and calculating usage.
Default: 1 (unigrams)</p></li>
<li><p><strong>strict</strong> (<em>bool</em>) – Should all ngrams be stemmed or left unstemmed for a more strict usage history.
Default: False (stem and clean all grams in the dataset)</p></li>
<li><p><strong>start_datetime</strong> (<em>Optional[Union[str, datetime]]</em>) – An optional datetime that the session dataset will start at.
Default: None (no datetime beginning bound on the dataset)</p></li>
<li><p><strong>end_datetime</strong> (<em>Optional[Union[str, datetime]]</em>) – An optional datetime that the session dataset will end at.
Default: None (no datetime end bound on the dataset)</p></li>
<li><p><strong>cache_dir</strong> (<em>Optional[Union[str, Path]]</em>) – An optional directory path to cache the dataset. Directory is created if it
does not exist.
Default: “./cdp-datasets”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gram_usage</strong> – A pandas DataFrame of all found ngrams (stemmed and cleaned or unstemmed and
uncleaned) from the data and their counts for each session and their percentage
of use as a percent of their use for the day over the sum of all other ngrams
used that day.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#cdp_data.datasets.get_session_dataset" title="cdp_data.datasets.get_session_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cdp_data.datasets.get_session_dataset</span></code></a></dt><dd><p>Function to pull or load a cached session dataset.</p>
</dd>
<dt><a class="reference internal" href="#cdp_data.keywords.plot_ngram_usage_histories" title="cdp_data.keywords.plot_ngram_usage_histories"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cdp_data.keywords.plot_ngram_usage_histories</span></code></a></dt><dd><p>Plot ngram usage history data.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This function calculates the counts and percentage of each ngram used for a day
over the sum of all other ngrams used in that day’s discussion(s). This is close but
not exactly the same as Google’s NGram Viewer: <a class="reference external" href="https://books.google.com/ngrams">https://books.google.com/ngrams</a></p>
<p>This function will pull a new session dataset and cache transcripts to the local
disk in the provided (or default) cache directory.</p>
<p>It is recommended to cache this dataset after computation because it may take a
while depending on machine resources and available.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cdp_data.keywords.fill_history_data_with_zeros">
<span class="sig-prename descclassname"><span class="pre">cdp_data.keywords.</span></span><span class="sig-name descname"><span class="pre">fill_history_data_with_zeros</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngram_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/cdp_data/keywords.html#fill_history_data_with_zeros"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdp_data.keywords.fill_history_data_with_zeros" title="Permalink to this definition">#</a></dt>
<dd><p>A utility function to fill ngram history data with zeros for all missing dates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The ngram history data to fill dates for.</p></li>
<li><p><strong>ngram_col</strong> (<em>str</em>) – The column name for which the “ngram” is stored.</p></li>
<li><p><strong>dt_col</strong> (<em>str</em>) – The column name for which the datetime is stored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> – A DataFrame filled with the original data and filled in with any missing dates
with their values being set to zero.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_ngram_history_plotting_data</span></code></dt><dd><p>Subsets to plotting only columns and ensures values are sorted and grouped.</p>
</dd>
</dl>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cdp_data.keywords.get_ngram_relevancy_history">
<span class="sig-prename descclassname"><span class="pre">cdp_data.keywords.</span></span><span class="sig-name descname"><span class="pre">get_ngram_relevancy_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngram</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_datetime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">datetime.datetime</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_datetime</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">datetime.datetime</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infrastructure_slug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/cdp_data/keywords.html#get_ngram_relevancy_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdp_data.keywords.get_ngram_relevancy_history" title="Permalink to this definition">#</a></dt>
<dd><p>Pull an n-gram’s relevancy history from a CDP database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ngram</strong> (<em>str</em>) – The unigram, bigram, or trigram to retrieve history for.</p></li>
<li><p><strong>strict</strong> (<em>bool</em>) – Should the provided ngram be used for a strict “unstemmed_gram” query or not.
Default: False (stem and clean the ngram before querying)</p></li>
<li><p><strong>start_datetime</strong> (<em>Optional[Union[str, datetime]]</em>) – The earliest possible datetime for ngram history to be retrieved for.
If provided as a string, the datetime should be in ISO format.</p></li>
<li><p><strong>end_datetime</strong> (<em>Optional[Union[str, datetime]]</em>) – The latest possible datetime for ngram history to be retrieved for.
If provided as a string, the datetime should be in ISO format.</p></li>
<li><p><strong>infrastructure_slug</strong> (<em>Optional[str]</em>) – The optional CDP infrastructure slug to connect to.
Default: None (you are managing the database connection yourself)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ngram_history</strong> – A pandas DataFrame of all IndexedEventGrams that match the provided ngram query
(stemmed or unstemmed).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#cdp_data.keywords.compute_ngram_usage_history" title="cdp_data.keywords.compute_ngram_usage_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cdp_data.keywords.compute_ngram_usage_history</span></code></a></dt><dd><p>Compute all ngrams usage history for a specific CDP session dataset. Useful for comparing how much discussion is comprised of specific ngrams.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>This function pulls the TF-IDF (or other future indexed values) score for the
provided ngram over time. This is a measure of relevancy to a document and not
the same as Google’s NGram Viewer which shows what percentage of literature
used the term.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cdp_data.keywords.plot_ngram_usage_histories">
<span class="sig-prename descclassname"><span class="pre">cdp_data.keywords.</span></span><span class="sig-name descname"><span class="pre">plot_ngram_usage_histories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngram</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gram_usage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmplot_kws</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">sns.FacetGrid</span></span></span><a class="reference internal" href="_modules/cdp_data/keywords.html#plot_ngram_usage_histories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdp_data.keywords.plot_ngram_usage_histories" title="Permalink to this definition">#</a></dt>
<dd><p>Select and plot specific ngram usage histories from the provided gram usage
DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ngram</strong> (<em>Union[str, List[str]]</em>) – The unigrams, bigrams, or trigrams to retrieve history for.
Note: Must provide all unigrams, bigrams, or trigrams, cannot mix gram size, and
the gram size should be the same as the grams stored in the provided gram_usage
DataFrame.</p></li>
<li><p><strong>gram_usage</strong> (<em>pd.DataFrame</em>) – A pandas DataFrame of all found ngrams (stemmed and cleaned or unstemmed and
uncleaned) from the data and their counts for each session and their percentage
of use as a percent of their use for the day over the sum of all other ngrams
used that day.</p></li>
<li><p><strong>strict</strong> (<em>bool</em>) – Should all ngrams be stemmed or left unstemmed for a more strict usage history.
Default: False (stem and clean all grams in the dataset)</p></li>
<li><p><strong>lmplot_kws</strong> (<em>Dict[str, Any]</em>) – Any extra kwargs to provide to sns.lmplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grid</strong> – The small multiples FacetGrid of all ngrams and infrastructures found in the
provided dataset.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sns.FacetGrid</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#cdp_data.keywords.compute_ngram_usage_history" title="cdp_data.keywords.compute_ngram_usage_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cdp_data.keywords.compute_ngram_usage_history</span></code></a></dt><dd><p>Function to generate ngram usage history DataFrame.</p>
</dd>
</dl>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="cdp_data.keywords.prepare_ngram_relevancy_history_plotting_data">
<span class="sig-prename descclassname"><span class="pre">cdp_data.keywords.</span></span><span class="sig-name descname"><span class="pre">prepare_ngram_relevancy_history_plotting_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngram_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'query_gram'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'event_datetime'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/cdp_data/keywords.html#prepare_ngram_relevancy_history_plotting_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdp_data.keywords.prepare_ngram_relevancy_history_plotting_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare an ngram relevancy history DataFrame specifically for plotting.
This function will subset the DataFrame to just the provided columns and
will only store a single value for each day if there are multiple
(keeping the max value).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The data to prepare for plotting.</p></li>
<li><p><strong>ngram_col</strong> (<em>str</em>) – The column name for which the “ngram” is stored.
Default: “query_gram”</p></li>
<li><p><strong>value_col</strong> (<em>str</em>) – The column name for which the value of each ngram is stored.
Default: “value”</p></li>
<li><p><strong>dt_col</strong> (<em>str</em>) – The column name for which the datetime is stored.
Default: “event_datetime”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>prepared</strong> – The subset and max selected dataset reading for plotting.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#cdp_data.keywords.get_ngram_relevancy_history" title="cdp_data.keywords.get_ngram_relevancy_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_ngram_relevancy_history</span></code></a></dt><dd><p>The dataset retrival function which should generally paired with this function.</p>
</dd>
</dl>
</div>
</dd></dl>
</section>
<section id="module-cdp_data">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-cdp_data" title="Permalink to this headline">#</a></h2>
<p>Top-level package for cdp_data.</p>
<dl class="py function">
<dt class="sig sig-object py" id="cdp_data.get_module_version">
<span class="sig-prename descclassname"><span class="pre">cdp_data.</span></span><span class="sig-name descname"><span class="pre">get_module_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/cdp_data.html#get_module_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdp_data.get_module_version" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="cdp_data.utils.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">cdp_data.utils package</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="modules.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">cdp_data</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Jackson Maxfield Brown
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">cdp_data package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-cdp_data.constants">cdp_data.constants module</a></li>
<li><a class="reference internal" href="#module-cdp_data.datasets">cdp_data.datasets module</a></li>
<li><a class="reference internal" href="#module-cdp_data.keywords">cdp_data.keywords module</a></li>
<li><a class="reference internal" href="#module-cdp_data">Module contents</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    </body>
</html>